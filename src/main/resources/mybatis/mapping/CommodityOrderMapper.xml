<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.orangeSoft.market.mapper.CommodityOrderMapper">
    <select id="findOrderDetailByOrderId" resultType="com.orangeSoft.market.pojo.OrderDetailResult">
        select commodity_order.order_id,
               shop_name,
               commodity_name,
               sub_name,
               price,
               count_commodity,
               address_details,
               status_date,
               dd.item_name,
               sub_icon
        from commodity_order
                 inner join order_logistics ol on commodity_order.order_id = ol.order_id
                 inner join receive_address ra on commodity_order.receive_address_id = ra.receive_address_id
                 inner join order_stateflow os on commodity_order.order_id = os.order_id
                 inner join data_dictionary dd on os.record_id = dd.record_id
                 inner join shop s on commodity_order.sid = s.sid
                 inner join sub_commodity sc on commodity_order.sub_id = sc.sub_id
                 inner join commodity c on s.sid = c.sid
        where commodity_order.order_id = #{orderId}
    </select>
    <select id="findUserOrderByUserId" resultType="com.orangeSoft.market.pojo.UserOrderResult">
        select commodity_order.order_id,
               shop_name,
               commodity_name,
               sub_name,
               price,
               count_commodity,
               dd.item_name,
               sub_icon
        from commodity_order
                 inner join receive_address ra on commodity_order.receive_address_id = ra.receive_address_id
                 inner join shop s on commodity_order.sid = s.sid
                 inner join sub_commodity sc on commodity_order.sub_id = sc.sub_id
                 inner join order_stateflow os on commodity_order.order_id = os.order_id
                 inner join data_dictionary dd on os.record_id = dd.record_id
                 inner join commodity c on s.sid = c.sid
        where commodity_order.uid = #{uid}
        order by order_id DESC
    </select>
    <select id="findSidBySubId" resultType="int">
        select co.sid
        from sub_commodity
                 inner join commodity co on sub_commodity.cid = co.cid
        where sub_id = #{subId}
    </select>
</mapper>
