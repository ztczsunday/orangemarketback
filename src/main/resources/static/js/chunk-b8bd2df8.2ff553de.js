(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b8bd2df8"],{"5c19":function(e,t,a){},"5e54":function(e,t,a){"use strict";a("5c19")},"77d0":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.mails,(function(t,s){return a("van-cell",{key:s},[a("ARow",[a("ARow",[a("ACol",{attrs:{span:"3"}},[a("a-avatar",{attrs:{src:t.oppSelfie}})],1),a("ACol",{style:{height:"5vw","font-size":"4vw","font-weight":"bold"},attrs:{span:"21"}},[e._v(" "+e._s(t.oppName)+" ")]),a("ACol",[e._v(" "+e._s(t["chatDate"][0])+"/"+e._s(t["chatDate"][1])+"/"+e._s(t["chatDate"][2])+" "+e._s(t["chatDate"][3])+":"+e._s(t["chatDate"][4])+":"+e._s(t["chatDate"][5])+" ")])],1),a("ARow",{staticStyle:{"font-size":"4vw",height:"5vw"}},[a("span",{staticStyle:{"font-weight":"bold",color:"red"}},[e._v(" "+e._s(t["senderId"]!==e.$store.state.user.uid?t.oppName:"我")+": ")]),a("span",[e._v(e._s(t["newChatContent"]))])]),a("ARow",[a("ACol",{attrs:{push:"21",span:"3"}},[a("van-icon",{attrs:{badge:t["isRead"]?1:"",name:"chat-o"},on:{click:function(t){return e.showPopup(s)}}})],1)],1),a("ARow",{staticStyle:{height:"5px"}})],1),a("van-popup",{staticStyle:{height:"95%"},attrs:{closeable:"",position:"bottom"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("SubMails",{attrs:{messages:e.subMailMessage},on:{update:function(t){return e.showPopup(e.currPage)}}})],1)],1)})),1)},n=[],o=a("1da1"),r=(a("96cf"),a("a9e3"),a("d3b7"),a("3ca3"),a("ddb0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("ARow",{staticStyle:{"margin-top":"10px"}},[a("ARow",[a("ACol",{staticStyle:{height:"5vw","font-size":"4vw","font-weight":"bold"},attrs:{push:"1",span:"23"}},[e._v(" "+e._s(e.messages.oppName)+" ")])],1),a("ARow",{style:{height:"10px"}}),e._l(e.messages.messages,(function(t,s){return a("VanCell",{key:s},[a("ARow",[a("ACol",{attrs:{span:"3"}},[a("a-avatar",{attrs:{src:t["senderId"]===e.$store.state.user.uid?e.messages.oppSelfie:e.messages.mySelfie}})],1),a("ACol",{staticStyle:{height:"5vw","font-size":"4vw","font-weight":"bold"},attrs:{span:"21"}},[e._v(" "+e._s(t["senderId"]===e.$store.state.user.uid?e.messages.oppName:"我")+" ")]),a("ACol",[e._v(" "+e._s(t["chatDate"][0])+"/"+e._s(t["chatDate"][1])+"/"+e._s(t["chatDate"][2])+" "+e._s(t["chatDate"][3])+":"+e._s(t["chatDate"][4])+":"+e._s(t["chatDate"][5])+" ")])],1),a("ARow",[a("ACol",{staticStyle:{"font-size":"4vw",height:"5vw"},attrs:{push:"1"}},[e._v(" "+e._s(t["chatDetails"])+" ")])],1)],1)}))],2),a("div",{staticClass:"footerDiv"},[a("ARow",{staticClass:"footer",attrs:{justify:"space-between",type:"flex"}},[a("ACol",[a("VanCellGroup",[a("van-field",{attrs:{autosize:{},label:"评论",placeholder:"写上你要回复的话",rows:"1",type:"textarea"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1)],1),a("ACol",[a("van-button",{attrs:{color:"orange",type:"primary"},on:{click:e.handleChatPush}},[e._v("发送")])],1)],1)],1)],1)}),i=[],p=a("d399"),l={name:"SubComments",props:{messages:{oppId:String,oppName:String,oppSelfie:String,oppType:String,mySelfie:String,myType:String,messages:Array}},data:function(){return{message:null}},methods:{handleChatPush:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var s,n,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.e("chunk-4a8a29de").then(a.bind(null,"31ca"));case 2:return s=t.sent,n=s.$,o=new FormData,o.append("myType",e.messages.myType),o.append("oppId",e.messages.oppId),o.append("oppType",e.messages.oppType),o.append("chatContent",e.message),t.next=11,n.post("/user/sendChat",o);case 11:r=t.sent,!0===r.data.success?p["a"].success("发送成功"):p["a"].fail("发送失败"),e.$emit("update"),e.message="";case 15:case"end":return t.stop()}}),t)})))()}}},c=l,u=(a("5e54"),a("2877")),h=Object(u["a"])(c,r,i,!1,null,"56fa499e",null),m=h.exports,d={name:"Mails",data:function(){return{show:!1,loading:null,finished:!1,mails:[],currPage:null,subMailMessage:{oppId:Number,oppName:String,oppSelfie:String,oppType:String,mySelfie:String,myType:String,messages:Array}}},methods:{onLoad:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var s,n,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.e("chunk-4a8a29de").then(a.bind(null,"31ca"));case 2:return s=t.sent,n=s.$,t.next=6,n.get("/user/aboutChats");case 6:o=t.sent,r=o.data.information,Array.prototype.push.apply(e.mails,r),console.log(r),e.finished=!0;case 11:case"end":return t.stop()}}),t)})))()},showPopup:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var n,o,r,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,a.e("chunk-4a8a29de").then(a.bind(null,"31ca"));case 2:return n=s.sent,o=n.$,r=t.mails[e]["oppId"],s.next=7,o.get("/user/receiveChats",{params:{oppUid:r,oppType:t.mails[e].oppType,selfType:t.mails[e].myType}});case 7:i=s.sent,t.subMailMessage.oppId=t.mails[e].oppId,t.subMailMessage.oppName=t.mails[e].oppName,t.subMailMessage.oppSelfie=t.mails[e].oppSelfie,t.subMailMessage.oppType=t.mails[e].oppType,t.subMailMessage.mySelfie=t.mails[e].mySelfie,t.subMailMessage.myType=t.mails[e].myType,t.subMailMessage.messages=i.data.information,t.currPage=e,t.show=!0;case 17:case"end":return s.stop()}}),s)})))()}},components:{SubMails:m}},g=d,f=Object(u["a"])(g,s,n,!1,null,"51c9e8e3",null);t["default"]=f.exports}}]);